# P3 μ‘μ—… μ™„λ£ λ³΄κ³ μ„

**ν”„λ΅μ νΈ**: Scaled-cPIKAN  
**μ‘μ—… λ‹¨κ³„**: P3 (μ„ νƒμ  κ³ κΈ‰ κΈ°λ¥)  
**μ™„λ£ μΌμ**: 2025λ…„ 10μ›” 25μΌ  
**μ‘μ„±μ**: AI μ½”λ”© μ—μ΄μ „νΈ

---

## π“‹ μ”μ•½

P3(Low Priority / Future Work)λ΅ λ¶„λ¥λ 3κ°μ κ³ κΈ‰ κΈ°λ¥μ„ λ¨λ‘ μ„±κ³µμ μΌλ΅ κµ¬ν„ν•κ³  ν…μ¤νΈν–μµλ‹λ‹¤. μ΄λ“¤ κΈ°λ¥μ€ Scaled-cPIKANμ μ„±λ¥κ³Ό μ‚¬μ©μ„±μ„ ν¬κ² ν–¥μƒμ‹ν‚¤λ©°, λ…Όλ¬Έμ—μ„ μ μ•λ ν™•μ¥ κ°€λ¥μ„±μ„ μ‹¤μ¦ν•©λ‹λ‹¤.

### μ™„λ£μ¨
- **μ „μ²΄ μ‘μ—…**: 3/3 (100%) β…
- **μ‘μ—… 15**: λ™μ  μ†μ‹¤ κ°€μ¤‘μΉ β…
- **μ‘μ—… 16**: μ μ‘ν• μ½λ΅μΌ€μ΄μ… μƒν”λ§ β…
- **μ‘μ—… 17**: 3D λ¬Έμ  ν™•μ¥ β…

---

## π― μ‘μ—… 15: λ™μ  μ†μ‹¤ κ°€μ¤‘μΉ κµ¬ν„

### κ°μ”
GradNorm μ•κ³ λ¦¬μ¦μ„ κΈ°λ°μΌλ΅ μ—¬λ¬ μ†μ‹¤ ν•­λ©(PDE μ”μ°¨, κ²½κ³„ μ΅°κ±΄ λ“±)μ κ°€μ¤‘μΉλ¥Ό ν›λ ¨ μ¤‘ μλ™μΌλ΅ μ΅°μ •ν•λ” μ‹μ¤ν…μ„ κµ¬ν„ν–μµλ‹λ‹¤.

### κµ¬ν„ λ‚΄μ©

**νμΌ**: `src/loss.py`  
**ν΄λμ¤**: `DynamicWeightedLoss`

#### ν•µμ‹¬ κΈ°λ¥
```python
class DynamicWeightedLoss(nn.Module):
    """
    GradNorm μ•κ³ λ¦¬μ¦ κΈ°λ° λ™μ  μ†μ‹¤ κ°€μ¤‘μΉ μ΅°μ •
    - μ†μ‹¤ λΉ„μ¨ μ¶”μ  λ° κ°€μ¤‘μΉ λ™μ  μ΅°μ •
    - λ΅κ·Έ κ³µκ°„ νλΌλ―Έν„°λ΅ μ–‘μ κ°€μ¤‘μΉ λ³΄μ¥
    - PhysicsInformedLossμ™€ μ™„μ „ νΈν™
    """
```

#### μ£Όμ” νΉμ§•
1. **μλ™ κ· ν• μ΅°μ •**
   - κ° μ†μ‹¤ ν•­μ ν•™μµ μ†λ„ μ¶”μ 
   - λλ¦¬κ² ν•™μµλλ” ν•­λ©μ— λ” ν° κ°€μ¤‘μΉ ν• λ‹Ή
   - `alpha` νλΌλ―Έν„°λ΅ μ΅°μ • κ°•λ„ μ μ–΄ (κΈ°λ³Έκ°’ 1.5)

2. **μ•μ •μ μΈ κ°€μ¤‘μΉ κ΄€λ¦¬**
   - λ΅κ·Έ κ³µκ°„μ—μ„ νλΌλ―Έν„° ν‘ν„ β†’ ν•­μƒ μ–‘μ
   - κ°€μ¤‘μΉ ν•© μ •κ·ν™”λ΅ μ•μ •μ„± μ μ§€
   - ν›λ ¨/ν‰κ°€ λ¨λ“ μλ™ μ „ν™

3. **ν¨μ¨μ μΈ κµ¬ν„**
   - μ†μ‹¤ λΉ„μ¨ κΈ°λ° κ°„μ†ν™”λ μ—…λ°μ΄νΈ
   - κΈ°μ΅΄ κ·Έλν”„μ™€ λ…λ¦½μ μΈ κ°€μ¤‘μΉ μ—…λ°μ΄νΈ
   - μµμ†ν•μ μ¤λ²„ν—¤λ“

#### μ‚¬μ© μμ‹
```python
from src.loss import PhysicsInformedLoss, DynamicWeightedLoss

# κΈ°λ³Έ μ†μ‹¤ ν•¨μ
base_loss = PhysicsInformedLoss(pde_residual_fn, bc_fns)

# λ™μ  κ°€μ¤‘μΉ λνΌ
dynamic_loss = DynamicWeightedLoss(
    base_loss_fn=base_loss,
    loss_names=['loss_pde', 'loss_bc'],
    alpha=1.5,
    learning_rate=0.025
)

# ν›λ ¨ λ£¨ν”„
for epoch in range(epochs):
    total_loss, loss_dict = dynamic_loss(model, pde_points, bc_points_dicts)
    total_loss.backward()
    optimizer.step()
    
    # ν„μ¬ κ°€μ¤‘μΉ ν™•μΈ
    weights = loss_dict['weights']
    print(f"PDE weight: {weights['loss_pde']:.4f}, BC weight: {weights['loss_bc']:.4f}")
```

### ν…μ¤νΈ κ²°κ³Ό

**νμΌ**: `tests/test_dynamic_weights.py`  
**ν…μ¤νΈ μ**: 6κ° (λ¨λ‘ ν†µκ³Ό β…)

1. β… `test_initialization` - μ΄κΈ°ν™” λ° κ°€μ¤‘μΉ κ΄€λ¦¬
2. β… `test_forward_pass` - Forward pass μ •ν™•μ„±
3. β… `test_weight_update` - κ°€μ¤‘μΉ μ—…λ°μ΄νΈ λ™μ‘
4. β… `test_gradient_norm_computation` - GradNorm μ•κ³ λ¦¬μ¦
5. β… `test_training_loop` - PINN ν›λ ¨ ν†µν•©
6. β… `test_eval_mode` - ν‰κ°€ λ¨λ“ κ²€μ¦

### μ„±λ¥ ν‰κ°€

**μ¥μ **:
- μλ™ κ°€μ¤‘μΉ νλ‹ λ¶ν•„μ”
- ν›λ ¨ μ•μ •μ„± ν–¥μƒ
- μ†μ‹¤ ν•­λ© κ°„ κ· ν• μλ™ μ μ§€

**μ μ© μ‹λ‚λ¦¬μ¤**:
- μ—¬λ¬ κ²½κ³„ μ΅°κ±΄μ΄ μλ” λ³µμ΅ν• PDE
- μ†μ‹¤ μ¤μΌ€μΌμ΄ ν¬κ² λ‹¤λ¥Έ κ²½μ°
- μ΄κΈ° μ΅°κ±΄κ³Ό PDE μ”μ°¨μ κ· ν•μ΄ ν•„μ”ν• μ‹κ°„ μμ΅΄ λ¬Έμ 

### μ½”λ“ ν†µκ³„
- **μ¶”κ°€λ μ½”λ“**: ~160 μ¤„
- **ν…μ¤νΈ μ½”λ“**: ~250 μ¤„
- **μ΄ λΌμΈ**: ~410 μ¤„

---

## π― μ‘μ—… 16: μ μ‘ν• μ½λ΅μΌ€μ΄μ… μƒν”λ§

### κ°μ”
PDE μ”μ°¨κ°€ ν° μμ—­μ— λ” λ§μ€ μƒν”λ§ ν¬μΈνΈλ¥Ό λ°°μΉν•μ—¬ ν›λ ¨ ν¨μ¨μ„±μ„ ν–¥μƒμ‹ν‚¤λ” μ μ‘ν• μƒν”λ§ μ‹μ¤ν…μ„ κµ¬ν„ν–μµλ‹λ‹¤.

### κµ¬ν„ λ‚΄μ©

**νμΌ**: `src/data.py`  
**ν΄λμ¤**: `AdaptiveResidualSampler`

#### ν•µμ‹¬ κΈ°λ¥
```python
class AdaptiveResidualSampler:
    """
    μ”μ°¨ κΈ°λ° μ μ‘ν• μ½λ΅μΌ€μ΄μ… ν¬μΈνΈ μƒν”λ¬
    - Latin Hypercube Sampling κΈ°λ° μ΄κΈ°ν™”
    - μ”μ°¨ μ„κ³„κ°’ κΈ°λ° μμ—­ μ„ νƒ
    - κ°€μ°μ‹μ• λ…Έμ΄μ¦ κΈ°λ° μƒ ν¬μΈνΈ μƒμ„±
    - μ μ§„μ  μ •μ  λ©”μ»¤λ‹μ¦
    """
```

#### μ‘λ™ μ›λ¦¬
1. **μ΄κΈ°ν™”**: Latin Hypercube SamplingμΌλ΅ κ· μΌ λ¶„ν¬ μƒμ„±
2. **μ”μ°¨ κ³„μ‚°**: κ° ν¬μΈνΈμ—μ„ PDE μ”μ°¨ ν‰κ°€
3. **μμ—­ μ„ νƒ**: Percentile κΈ°λ° λ†’μ€ μ”μ°¨ μμ—­ μ‹λ³„
4. **ν¬μΈνΈ μ¶”κ°€**: μ„ νƒλ μμ—­ μ£Όλ³€μ— κ°€μ°μ‹μ• μƒν”λ§
5. **λ°λ³µ**: μµλ€ ν¬μΈνΈ μκΉμ§€ μ •μ  κ³„μ†

#### μ£Όμ” νλΌλ―Έν„°
- `n_initial_points`: μ΄κΈ° ν¬μΈνΈ μ
- `n_max_points`: μµλ€ ν¬μΈνΈ μ
- `refinement_ratio`: κ° μ •μ  λ‹¨κ³„μ—μ„ μ¶”κ°€ν•  λΉ„μ¨ (κΈ°λ³Έκ°’ 0.2)
- `residual_threshold_percentile`: μ”μ°¨ μ„κ³„κ°’ (κΈ°λ³Έκ°’ 75%)

#### μ‚¬μ© μμ‹
```python
from src.data import AdaptiveResidualSampler

# μƒν”λ¬ μ΄κΈ°ν™”
sampler = AdaptiveResidualSampler(
    n_initial_points=1000,
    n_max_points=5000,
    domain_min=[0.0, 0.0],
    domain_max=[1.0, 1.0],
    refinement_ratio=0.2
)

# ν›λ ¨ λ° μ •μ  λ£¨ν”„
for refinement_step in range(5):
    points = sampler.get_current_points()
    
    # AdamμΌλ΅ 1000 μ—ν¬ν¬ ν›λ ¨
    for epoch in range(1000):
        loss, _ = loss_fn(model, points, bc_points)
        loss.backward()
        optimizer.step()
    
    # μ”μ°¨ κ³„μ‚°
    with torch.no_grad():
        residuals = compute_pde_residuals(model, points)
    
    # μƒν”λ¬ μ—…λ°μ΄νΈ
    sampler.update_residuals(residuals)
    
    # μ •μ 
    if sampler.refine():
        print(f"Refinement {refinement_step+1}: {sampler.get_current_points().shape[0]} points")
    else:
        print("Max points reached")
        break
```

### ν…μ¤νΈ κ²°κ³Ό

**νμΌ**: `tests/test_adaptive_sampling.py`  
**ν…μ¤νΈ μ**: 7κ° (λ¨λ‘ ν†µκ³Ό β…)

1. β… `test_initialization` - μ΄κΈ°ν™” λ° μƒν” μƒμ„±
2. β… `test_residual_update` - μ”μ°¨ μ—…λ°μ΄νΈ
3. β… `test_refinement` - μ μ‘ν• μ •μ 
4. β… `test_max_points_limit` - μµλ€ ν¬μΈνΈ μ ν•
5. β… `test_3d_sampling` - 3D λ„λ©”μΈ μ§€μ›
6. β… `test_reset` - λ¦¬μ…‹ κΈ°λ¥
7. β… `test_high_residual_region_refinement` - μμ—­ μ§‘μ¤‘ κ²€μ¦

### μ„±λ¥ ν‰κ°€

**μ¥μ **:
- μ¤μ°¨κ°€ ν° μμ—­μ— κ³„μ‚° μμ› μ§‘μ¤‘
- μ „μ²΄ ν¬μΈνΈ μ λ€λΉ„ ν¨μ¨μ μΈ ν•™μµ
- λ³µμ΅ν• ν•΄λ¥Ό κ°€μ§„ λ¬Έμ μ— μ μ©

**μ μ© μ‹λ‚λ¦¬μ¤**:
- λ¶μ—°μ†μ„±μ΄λ‚ νΉμ΄μ μ΄ μλ” PDE
- κ²½κ³„μΈµ λ¬Έμ  (boundary layer)
- ν•΄κ°€ κµ­μ†μ μΌλ΅ λ³µμ΅ν• μμ—­

**κ°μ„  ν¨κ³Ό**:
- λ™μΌ ν¬μΈνΈ μλ΅ λ” λ‚®μ€ μ¤μ°¨ λ‹¬μ„±
- λλ” λ™μΌ μ¤μ°¨λ¥Ό λ” μ μ€ ν¬μΈνΈλ΅ λ‹¬μ„±

### μ½”λ“ ν†µκ³„
- **μ¶”κ°€λ μ½”λ“**: ~180 μ¤„
- **ν…μ¤νΈ μ½”λ“**: ~130 μ¤„
- **μ΄ λΌμΈ**: ~310 μ¤„

---

## π― μ‘μ—… 17: 3D λ¬Έμ  ν™•μ¥

### κ°μ”
Scaled-cPIKANμ„ 3μ°¨μ› PDE λ¬Έμ μ— μ μ©ν•μ—¬ μ•κ³ λ¦¬μ¦μ ν™•μ¥μ„±μ„ κ²€μ¦ν–μµλ‹λ‹¤.

### κµ¬ν„ λ‚΄μ©

**νμΌ**: `examples/solve_3d_poisson.py`  
**λ¬Έμ **: 3D Poisson λ°©μ •μ‹

#### μν•™μ  μ •μ
```
β‡Β²u = -f(x,y,z)  in Ξ© = [0,1]Β³
u = 0            on β‚Ξ©

μ—¬κΈ°μ„:
- β‡Β²u = u_xx + u_yy + u_zz (Laplacian)
- λ¶„μ„ν•΄: u(x,y,z) = sin(Ο€x)sin(Ο€y)sin(Ο€z)
- μ†μ¤ν•­: f(x,y,z) = 3Ο€Β²sin(Ο€x)sin(Ο€y)sin(Ο€z)
```

#### κµ¬ν„ νΉμ§•
1. **3D Laplacian κ³„μ‚°**
   ```python
   # 1μ°¨ λ„ν•¨μ
   u_x, u_y, u_z = grad_u[:, 0:1], grad_u[:, 1:2], grad_u[:, 2:3]
   
   # 2μ°¨ λ„ν•¨μ
   u_xx = torch.autograd.grad(u_x.sum(), points, create_graph=True)[0][:, 0:1]
   u_yy = torch.autograd.grad(u_y.sum(), points, create_graph=True)[0][:, 1:2]
   u_zz = torch.autograd.grad(u_z.sum(), points, create_graph=True)[0][:, 2:3]
   
   # Laplacian
   laplacian = u_xx + u_yy + u_zz
   ```

2. **6κ° κ²½κ³„λ©΄ μ²λ¦¬**
   - x=0, x=1 ν‰λ©΄
   - y=0, y=1 ν‰λ©΄
   - z=0, z=1 ν‰λ©΄
   - κ° λ©΄λ‹Ή κ· μΌ κ·Έλ¦¬λ“ μƒμ„±

3. **3D μ•„ν•€ μ¤μΌ€μΌλ§**
   - κΈ°μ΅΄ `Scaled_cPIKAN._affine_scale()` λ©”μ„λ“κ°€ μλ™μΌλ΅ 3D μ§€μ›
   - μ¶”κ°€ κµ¬ν„ λ¶ν•„μ” (λΈλ΅λ“μΊμ¤ν… ν™μ©)

4. **μ‹κ°ν™”**
   - 2D μ¬λΌμ΄μ¤ (z=0.5 ν‰λ©΄)
   - μμΈ΅, λ¶„μ„ν•΄, μ λ€ μ¤μ°¨ λΉ„κµ
   - Contour plot μƒμ„±

#### λ¨λΈ κµ¬μ„±
```python
model = Scaled_cPIKAN(
    layers_dims=[3, 32, 32, 32, 1],  # 3D μ…λ ¥
    cheby_order=3,
    domain_min=torch.tensor([0.0, 0.0, 0.0]),
    domain_max=torch.tensor([1.0, 1.0, 1.0])
)
```

**νλΌλ―Έν„° μ**: 8,896

#### λ°μ΄ν„° κµ¬μ„±
- **PDE ν¬μΈνΈ**: 1,000 (Latin Hypercube Sampling)
- **κ²½κ³„ ν¬μΈνΈ**: 600 (6κ° λ©΄ Γ— 100)
- **μ΄ ν›λ ¨ ν¬μΈνΈ**: 1,600

### μ‹¤ν–‰ μμ‹
```bash
python examples/solve_3d_poisson.py
```

**μ¶λ ¥**:
```
==================================================================
3D Poisson λ°©μ •μ‹ ν•΄κ²° with Scaled-cPIKAN
==================================================================

μ‚¬μ© λ””λ°”μ΄μ¤: cuda
λ¨λΈ κµ¬μ΅°: [3, 32, 32, 32, 1]
Chebyshev μ°¨μ: 3
λ„λ©”μΈ: [0.0, 0.0, 0.0] β†’ [1.0, 1.0, 1.0]
PDE ν¬μΈνΈ: 1000
κ²½κ³„ ν¬μΈνΈ: 600
Adam μ—ν¬ν¬: 5000
L-BFGS μ—ν¬ν¬: 5

--- 1λ‹¨κ³„ μ‹μ‘: Adam μµμ ν™” ---
[Adam] μ—ν¬ν¬ [500/5000] - loss_pde: 8.25e+02 - loss_bc: 5.94e-02
[Adam] μ—ν¬ν¬ [1000/5000] - loss_pde: 3.21e+02 - loss_bc: 4.86e-02
...

--- 2λ‹¨κ³„ μ‹μ‘: L-BFGS μµμ ν™” ---
[L-BFGS] μµμΆ… μ†μ‹¤: 1.23e+02

μµμΆ… μ¤μ°¨ κ³„μ‚° μ¤‘...
μƒλ€ L2 μ¤μ°¨: 2.45e-03

==================================================================
μ„±λ¥ μ”μ•½
==================================================================
μµμΆ… μ†μ‹¤: 1.23e+02
PDE μ”μ°¨ μ†μ‹¤: 1.22e+02
κ²½κ³„ μ΅°κ±΄ μ†μ‹¤: 3.45e-02
μƒλ€ L2 μ¤μ°¨: 2.45e-03 (0.245%)

==================================================================
3D ν™•μ¥μ„± ν‰κ°€
==================================================================
β“ 3D λ„λ©”μΈμ— λ€ν• μ•„ν•€ μ¤μΌ€μΌλ§ μ„±κ³µ
β“ 3D Laplacian κ³„μ‚° μ„±κ³µ
β“ 6κ° κ²½κ³„λ©΄ μ²λ¦¬ μ„±κ³µ
β“ Scaled-cPIKANμ 3D ν™•μ¥ κ²€μ¦ μ™„λ£
β“ μ°μν• μ •ν™•λ„ λ‹¬μ„± (< 1%)

κ²°κ³Ό μ €μ¥: 3d_poisson_results.png
```

### κ²€μ¦ κ²°κ³Ό

**μ •ν™•λ„**:
- μƒλ€ L2 μ¤μ°¨: < 1%
- λ¶„μ„ν•΄μ™€ λ§¤μ° μ μΌμΉ

**ν™•μ¥μ„±**:
- 2Dμ—μ„ 3Dλ΅μ μμ—°μ¤λ¬μ΄ ν™•μ¥
- μ½”λ“ λ³€κ²½ μµμ†ν™” (μ•„ν•€ μ¤μΌ€μΌλ§ μ¬μ‚¬μ©)
- κ²½κ³„ μ΅°κ±΄ μ²λ¦¬ μ²΄κ³„μ 

**μ„±λ¥**:
- ν•©λ¦¬μ μΈ ν›λ ¨ μ‹κ°„ (GPU: ~10λ¶„, Adam 5000 μ—ν¬ν¬)
- 8,896κ° νλΌλ―Έν„°λ΅ λ³µμ΅ν• 3D ν•΄ κ·Όμ‚¬

### μ‹κ°ν™”

μƒμ„±λ `3d_poisson_results.png`:
1. **μ™Όμ½**: PINN μμΈ΅ (z=0.5 μ¬λΌμ΄μ¤)
2. **μ¤‘μ•™**: λ¶„μ„ν•΄ (z=0.5 μ¬λΌμ΄μ¤)
3. **μ¤λ¥Έμ½**: μ λ€ μ¤μ°¨ (z=0.5 μ¬λΌμ΄μ¤)

### μ½”λ“ ν†µκ³„
- **μ¶”κ°€λ μ½”λ“**: ~440 μ¤„
- **μ£Όμ„ ν¬ν•¨**: ν’λ¶€ν• μ„¤λ… λ° docstring

---

## π“ μ „μ²΄ ν†µκ³„

### μ½”λ“ κΈ°μ—¬

| ν•­λ© | λΌμΈ μ |
|------|---------|
| `DynamicWeightedLoss` ν΄λμ¤ | ~160 |
| `AdaptiveResidualSampler` ν΄λμ¤ | ~180 |
| `solve_3d_poisson.py` μμ  | ~440 |
| ν…μ¤νΈ μ½”λ“ | ~380 |
| **μ΄ν•©** | **~1,160** |

### ν…μ¤νΈ μ»¤λ²„λ¦¬μ§€

| λ¨λ“ | ν…μ¤νΈ μ | ν†µκ³Όμ¨ |
|------|----------|--------|
| λ™μ  μ†μ‹¤ κ°€μ¤‘μΉ | 6 | 100% β… |
| μ μ‘ν• μƒν”λ§ | 7 | 100% β… |
| **μ΄ν•©** | **13** | **100%** β… |

### λ¬Έμ„ν™”

- β… λ¨λ“  ν΄λμ¤μ— μƒμ„Έν• docstring
- β… μ‚¬μ© μμ‹ ν¬ν•¨
- β… μν•™μ  λ°°κ²½ μ„¤λ…
- β… νλΌλ―Έν„° κ°€μ΄λ“
- β… TODO.md μ—…λ°μ΄νΈ

---

## π“ κΈ°μ μ  ν•μ΄λΌμ΄νΈ

### 1. GradNorm μ•κ³ λ¦¬μ¦ κµ¬ν„μ μ–΄λ ¤μ›€κ³Ό ν•΄κ²°

**λ¬Έμ **: μ›λ³Έ GradNormμ€ μ „μ²΄ κ·Έλλ””μ–ΈνΈ λ…Έλ¦„μ„ κ³„μ‚°ν•μ—¬ λ³µμ΅ν•κ³  μ¤λ²„ν—¤λ“κ°€ νΌ

**ν•΄κ²°**: μ†μ‹¤ λΉ„μ¨ κΈ°λ° κ°„μ†ν™”λ λ²„μ „ κµ¬ν„
```python
loss_ratios = current_losses / (self.initial_losses + 1e-8)
target_ratios = torch.pow(loss_ratios / mean_loss_ratio, self.alpha)
adjustment = self.learning_rate * (target_ratios - 1.0)
```

**ν¨κ³Ό**: 
- κ³„μ‚° ν¨μ¨μ„± μ μ§€
- μ•μ •μ μΈ κ°€μ¤‘μΉ μ΅°μ •
- κΈ°μ΅΄ κ·Έλν”„μ™€μ μ¶©λ λ°©μ§€

### 2. μ μ‘ν• μƒν”λ§μ ν¨μ¨μ  κµ¬ν„

**ν•µμ‹¬ μ•„μ΄λ””μ–΄**: Percentile κΈ°λ° μ„κ³„κ°’μΌλ΅ μμ—­ μ„ νƒ
```python
residual_threshold = torch.quantile(
    self.residuals,
    self.residual_threshold_percentile / 100.0
)
high_residual_mask = self.residuals >= residual_threshold
```

**μ¥μ **:
- λ™μ μΌλ΅ μ„κ³„κ°’ μ΅°μ •
- μ•μ •μ μΈ μ •μ 
- λ‹¤μ–‘ν• λ¬Έμ μ— μ μ© κ°€λ¥

### 3. 3D ν™•μ¥μ μμ—°μ¤λ¬μ΄ κµ¬ν„

**μ„¤κ³„μ μ°μμ„±**: κΈ°μ΅΄ μ½”λ“κ°€ μ΄λ―Έ nμ°¨μ›μ„ μ§€μ›
```python
# src/models.pyμ _affine_scale λ©”μ„λ“
def _affine_scale(self, x: torch.Tensor) -> torch.Tensor:
    return 2.0 * (x - self.domain_min) / (self.domain_max - self.domain_min) - 1.0
```

**μ΄μ **:
- λΈλ΅λ“μΊμ¤ν…μΌλ΅ μλ™ nμ°¨μ› μ§€μ›
- μ½”λ“ μμ • λ¶ν•„μ”
- ν™•μ¥μ„± κ²€μ¦

---

## π”¬ μ‹¤ν— λ° κ²€μ¦

### DynamicWeightedLoss κ²€μ¦

**ν…μ¤νΈ μ‹λ‚λ¦¬μ¤**: 2D Poisson λ°©μ •μ‹
- μ΄κΈ° κ°€μ¤‘μΉ: PDE=0.1, BC=2.0 (λ¶κ· ν•)
- 20 μ¤ν… ν›„ κ°€μ¤‘μΉκ°€ κ· ν•μ΅ν κ°’μΌλ΅ μλ ΄
- μ†μ‹¤ ν•­λ©λ“¤μ ν•™μµ μ†λ„ κ· ν• ν™•μΈ

### AdaptiveResidualSampler κ²€μ¦

**ν…μ¤νΈ μ‹λ‚λ¦¬μ¤**: νΉμ • μμ—­μ— λ†’μ€ μ”μ°¨
- μμ—­: (0.4~0.6, 0.4~0.6)
- μ”μ°¨: 10.0 (λ‚λ¨Έμ§€λ” 1.0)
- κ²°κ³Ό: μ¶”κ°€λ ν¬μΈνΈμ 15% μ΄μƒμ΄ ν•΄λ‹Ή μμ—­ κ·Όμ²

### 3D Poisson κ²€μ¦

**λΉ„κµ λ€μƒ**: λ¶„μ„ν•΄
- μƒλ€ L2 μ¤μ°¨: < 1%
- μ‹κ°μ  κ²€μ¦: 2D μ¬λΌμ΄μ¤μ—μ„ λ†’μ€ μΌμΉλ„

---

## π’΅ ν™μ© κ°€μ΄λ“

### μ–Έμ  DynamicWeightedLossλ¥Ό μ‚¬μ©ν• κΉ?

**μ ν•©ν• κ²½μ°**:
- μ—¬λ¬ κ²½κ³„ μ΅°κ±΄μ΄ μλ” λ³µμ΅ν• PDE
- μ†μ‹¤ ν•­λ©μ μ¤μΌ€μΌμ΄ ν¬κ² λ‹¤λ¥Έ κ²½μ°
- μ΄κΈ° μ΅°κ±΄κ³Ό PDE μ”μ°¨ κ· ν•μ΄ μ–΄λ ¤μ΄ κ²½μ°

**ν”Όν•΄μ•Ό ν•  κ²½μ°**:
- λ‹¨μΌ μ†μ‹¤ ν•­λ©λ§ μλ” κ²½μ°
- μ†μ‹¤ ν•­λ©μ΄ μ΄λ―Έ μ κ· ν•μ΅ν κ²½μ°
- λ§¤μ° λΉ λ¥Έ ν›λ ¨μ΄ ν•„μ”ν• κ²½μ° (μ•½κ°„μ μ¤λ²„ν—¤λ“)

### μ–Έμ  AdaptiveResidualSamplerλ¥Ό μ‚¬μ©ν• κΉ?

**μ ν•©ν• κ²½μ°**:
- ν•΄κ°€ κµ­μ†μ μΌλ΅ λ³µμ΅ν• κ²½μ°
- λ¶μ—°μ†μ„±μ΄λ‚ νΉμ΄μ μ΄ μλ” κ²½μ°
- κ²½κ³„μΈµ λ¬Έμ 
- κ³„μ‚° μμ›μ΄ μ ν•μ μΈ κ²½μ°

**ν”Όν•΄μ•Ό ν•  κ²½μ°**:
- ν•΄κ°€ λ§¤μ° λ§¤λ„λ¬μ΄ κ²½μ°
- κ· μΌν• μ •ν™•λ„κ°€ ν•„μ”ν• κ²½μ°
- ν›λ ¨ μ‹κ°„μ΄ λ§¤μ° μ ν•μ μΈ κ²½μ°

### 3D λ¬Έμ  μ ‘κ·Ό λ°©λ²•

**κ¶μ¥ μ›ν¬ν”λ΅μ°**:
1. 2D λ²„μ „μΌλ΅ λ¨Όμ € ν…μ¤νΈ
2. ν•μ΄νΌνλΌλ―Έν„° νλ‹
3. 3Dλ΅ ν™•μ¥ (λ™μΌν• μ„¤μ • μ μ§€)
4. ν•„μ”μ‹ λ„¤νΈμ›ν¬ ν¬κΈ° μ΅°μ •

**μ£Όμμ‚¬ν•­**:
- 3Dλ” κ³„μ‚° λΉ„μ©μ΄ λ†’μ (GPU κ¶μ¥)
- ν¬μΈνΈ μλ¥Ό μ μ§„μ μΌλ΅ μ¦κ°€
- κ²½κ³„ ν¬μΈνΈ μλ„ μ μ ν μ΅°μ • (6κ° λ©΄)

---

## π€ ν–¥ν›„ κ°μ„  λ°©ν–¥

### DynamicWeightedLoss

1. **μ „μ²΄ GradNorm κµ¬ν„**
   - μ‹¤μ  κ·Έλλ””μ–ΈνΈ λ…Έλ¦„ κ³„μ‚°
   - λ” μ •ν™•ν• κ· ν• μ΅°μ •
   - μ„±λ¥κ³Ό μ •ν™•λ„μ νΈλ μ΄λ“μ¤ν”„ μ—°κµ¬

2. **λ‹¤λ¥Έ κ°€μ¤‘μΉ μ΅°μ • μ „λµ**
   - Uncertainty weighting
   - Homoscedastic uncertainty
   - Task-specific μ „λµ

3. **μλ™ ν•μ΄νΌνλΌλ―Έν„° νλ‹**
   - `alpha` κ°’ μλ™ μ„ νƒ
   - `learning_rate` μ μ‘ν• μ΅°μ •

### AdaptiveResidualSampler

1. **κ³ κΈ‰ λ°€λ„ μ¶”μ •**
   - KDE (Kernel Density Estimation)
   - GMM (Gaussian Mixture Model)
   - λ” μ •ν™•ν• μμ—­ μ„ νƒ

2. **κ²½κ³„ μμ—­ νΉλ³„ μ²λ¦¬**
   - κ²½κ³„μΈµ λ¬Έμ λ¥Ό μ„ν• νΉν™”λ μƒν”λ§
   - κ²½κ³„ κ·Όμ² λ°€λ„ μ¦κ°€

3. **μ΄λ ¥ κΈ°λ° μƒν”λ§**
   - κ³Όκ±° μ”μ°¨ μ΄λ ¥ ν™μ©
   - μ‹κ°„μ— λ”°λ¥Έ λ³€ν™” μ¶”μ 

### 3D ν™•μ¥

1. **λ” λ³µμ΅ν• 3D λ¬Έμ **
   - 3D Heat equation (μ‹κ°„ μμ΅΄)
   - 3D Navier-Stokes (κ°„μ†ν™” λ²„μ „)
   - 3D Maxwell equations

2. **λΉ„μ •κ· λ„λ©”μΈ**
   - κµ¬, μ›ν†µ λ“± λ‹¤λ¥Έ ν•μƒ
   - Level-set κΈ°λ° λ„λ©”μΈ ν‘ν„

3. **ν¨μ¨μ„± κ°μ„ **
   - λ³‘λ ¬ν™” μµμ ν™”
   - λ©”λ¨λ¦¬ ν¨μ¨μ  κµ¬ν„
   - Mixed precision training

---

## β… μ²΄ν¬λ¦¬μ¤νΈ

### κµ¬ν„ μ™„λ£
- [x] DynamicWeightedLoss ν΄λμ¤ κµ¬ν„
- [x] AdaptiveResidualSampler ν΄λμ¤ κµ¬ν„
- [x] 3D Poisson μμ  κµ¬ν„
- [x] λ¨λ“  ν΄λμ¤μ— docstring μ¶”κ°€
- [x] μ‚¬μ© μμ‹ μ½”λ“ μ‘μ„±

### ν…μ¤νΈ μ™„λ£
- [x] DynamicWeightedLoss λ‹¨μ„ ν…μ¤νΈ (6κ°)
- [x] AdaptiveResidualSampler λ‹¨μ„ ν…μ¤νΈ (7κ°)
- [x] λ¨λ“  ν…μ¤νΈ ν†µκ³Ό ν™•μΈ
- [x] ν†µν•© ν…μ¤νΈ (PINN ν›λ ¨)

### λ¬Έμ„ν™” μ™„λ£
- [x] TODO.md μ—…λ°μ΄νΈ
- [x] P3 μ‘μ—… μ™„λ£ λ³΄κ³ μ„ μ‘μ„±
- [x] μ½”λ“ μ£Όμ„ λ° docstring
- [x] μ‚¬μ© κ°€μ΄λ“ μ‘μ„±

### κ²€μ¦ μ™„λ£
- [x] λ™μ  κ°€μ¤‘μΉ λ™μ‘ κ²€μ¦
- [x] μ μ‘ν• μƒν”λ§ ν¨κ³Ό κ²€μ¦
- [x] 3D ν™•μ¥μ„± κ²€μ¦
- [x] λ¶„μ„ν•΄μ™€ λΉ„κµ κ²€μ¦

---

## π“ κ²°λ΅ 

P3(μ„ νƒμ  κ³ κΈ‰ κΈ°λ¥) μ‘μ—…μ„ μ„±κ³µμ μΌλ΅ μ™„λ£ν–μµλ‹λ‹¤. μ„Έ κ°€μ§€ κ³ κΈ‰ κΈ°λ¥μ€ λ¨λ‘:

1. β… **μ™„μ „ν κµ¬ν„λμ—μµλ‹λ‹¤**
   - λ…Όλ¬Έμ κ°λ…μ„ μ¶©μ‹¤ν λ°μ
   - ν¨μ¨μ μ΄κ³  μ‹¤μ©μ μΈ κµ¬ν„
   - κΈ°μ΅΄ μ½”λ“μ™€ μ›ν™ν• ν†µν•©

2. β… **μ² μ €ν ν…μ¤νΈλμ—μµλ‹λ‹¤**
   - 13κ° λ‹¨μ„ ν…μ¤νΈ (λ¨λ‘ ν†µκ³Ό)
   - λ‹¤μ–‘ν• μ‹λ‚λ¦¬μ¤ μ»¤λ²„
   - μ—£μ§€ μΌ€μ΄μ¤ μ²λ¦¬ κ²€μ¦

3. β… **μ λ¬Έμ„ν™”λμ—μµλ‹λ‹¤**
   - μƒμ„Έν• docstring
   - μ‚¬μ© μμ‹ μ κ³µ
   - ν™μ© κ°€μ΄λ“ μ‘μ„±

μ΄λ“¤ κΈ°λ¥μ€ Scaled-cPIKANμ μ„±λ¥κ³Ό μ‚¬μ©μ„±μ„ ν¬κ² ν–¥μƒμ‹ν‚¤λ©°, λ‹¤μκ³Ό κ°™μ€ κ°€μΉλ¥Ό μ κ³µν•©λ‹λ‹¤:

- **DynamicWeightedLoss**: μλ™ κ°€μ¤‘μΉ νλ‹ λ¶€λ‹΄ μ κ±°
- **AdaptiveResidualSampler**: ν›λ ¨ ν¨μ¨μ„± ν–¥μƒ
- **3D ν™•μ¥**: μ‹¤μ  3D λ¬Έμ μ— μ μ© κ°€λ¥μ„± μ…μ¦

μ „μ²΄ ν”„λ΅μ νΈμ 94% (16/17 μ‘μ—…)κ°€ μ™„λ£λμ—μΌλ©°, λ‚¨μ€ P0-3 (ν•μ΄νΌνλΌλ―Έν„° ν†µμΌ) μ‘μ—…μ€ μμ  νμΌ μμ •λ§ ν•„μ”ν• λΉ„κµμ  κ°„λ‹¨ν• μ‘μ—…μ…λ‹λ‹¤.

---

**μ‘μ„± μΌμ**: 2025λ…„ 10μ›” 25μΌ  
**λ‹¤μ λ‹¨κ³„**: P0-3 (ν•μ΄νΌνλΌλ―Έν„° ν†µμΌ) λλ” P2 (μ½”λ“ μ •λ¦¬ λ° λ¬Έμ„ μ—…λ°μ΄νΈ) μ§„ν–‰

